<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>zeus</title>

    <link id="bootstrap" rel="stylesheet" type="text/css" href="./css/bootstrap/5/bootstrap-default.min.css">
    <link id="bootstrapIcon" rel="stylesheet" type="text/css" href="./css/bootstrap-icons/1/font/bootstrap-icons.min.css">
    <style>
        .rotate {
            animation: rotate 1s linear infinite;
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .fan-container {
            max-width: 60px;
        }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg sticky-top bg-primary">
        <div class="container-sm">
            <a class="navbar-brand" href="#">
                <img src="./images/ecozeus_headlogo.gif" class="p-1 rounded bg-white">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <div class="flex-grow-1 d-flex justify-content-center align-items-center gap-2">
                    <div class="d-flex flex-column justify-content-center align-items-center text-white p-2 border-bottom border-white">
                        <i class="bi bi-display fs-4"></i>
                        <label class="fs-5">トップ</label>
                    </div>

                    <a class="btn btn-sm btn-primary d-flex flex-column justify-content-center align-items-center" href="./control.html">
                        <i class="bi bi-cpu fs-5"></i>
                        <label class="fs-6" role="button">制御レベル</label>
                    </a>
                    
                    <a class="btn btn-sm btn-primary d-flex flex-column justify-content-center align-items-center" href="./powerUsage.html" role="button">
                        <i class="bi bi-lightning fs-5"></i>
                        <label class="fs-6" role="button">電力使用状況</label>
                    </a>

                    <a class="btn btn-sm btn-primary d-flex flex-column justify-content-center align-items-center" href="./electricityGeneration.html" role="button">
                        <i class="bi bi-sun fs-5"></i>
                        <label class="fs-6" role="button">発電監視</label>
                    </a>

                    <a class="btn btn-sm btn-primary d-flex flex-column justify-content-center align-items-center" href="./noah.html">
                        <i class="bi bi-fan fs-5"></i>
                        <label class="fs-6" role="button">換気制御</label>
                    </a>

                    <a class="btn btn-sm btn-primary d-flex flex-column justify-content-center align-items-center" href="./electricSensor.html">
                        <i class="bi bi-bar-chart-line fs-5"></i>
                        <label class="fs-6" role="button">個別計測</label>
                    </a>

                    <select id="theme" name="theme" title="theme" class="form-select d-none">
                        <option value="default">default</option>
                        <option value="cerulean">cerulean</option>
                        <option value="cosmo">cosmo</option>
                        <option value="litera">litera</option>
                        <option value="lumen">lumen</option>
                        <option value="materia">materia</option>
                        <option value="pulse">pulse</option>
                        <option value="sandstone">sandstone</option>
                        <option value="spacelab">spacelab</option>
                        <option value="zephyr">zephyr</option>
                    </select>
                </div>

                <div class="d-flex gap-2 text-white">
                    demo | <a class="nav-link" href="#">ログアウト</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-lg">
        <nav>
            <div class="nav nav-tabs nav-fill my-3" id="top-nav-tab" role="tablist">
                <button type="button" role="tab" id="nav-demand-pg-tab" class="nav-link fs-5 fw-bold active" data-bs-toggle="tab" data-bs-target="#nav-demand-pg">
                    デマンド・発電状況
                </button>
                <button type="button" role="tab" id="nav-ac-tab" class="nav-link fs-5 fw-bold" data-bs-toggle="tab" data-bs-target="#nav-ac">
                    空調制御
                </button>
                <button type="button" role="tab" id="nav-ventilation-tab" class="nav-link fs-5 fw-bold" data-bs-toggle="tab" data-bs-target="#nav-ventilation">
                    換気制御
                </button>
                <button type="button" role="tab" id="nav-inverter-tab" class="nav-link fs-5 fw-bold" data-bs-toggle="tab" data-bs-target="#nav-inverter">
                    インバーター制御
                </button>
            </div>
        </nav>

        <div class="tab-content" id="myTabContent">
            <!--デマンド・発電状況-->
            <div class="tab-pane fade show active" id="nav-demand-pg" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                <!-- デマンド状況フレーム -->
                <div class="container mt-3 pb-3 fs-6 fw-bold border-bottom border-primary-subtle">
        
                    <div class="row g-3">
                        <div class="col-8">
        
                            <div class="flex-fill row row-cols-2 g-3 text-center">

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>デマンド予測値【kW】</label>
                                        <div class="flex-fill d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">75</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>目標デマンド値【kW】</label>
                                        <div class="flex-fill d-flex justify-content-center align-items-end">
                                            <label class="fs-1 text-primary">110</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>瞬時電力【kW】</label>
                                        <div class="flex-fill d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">50</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>当月最大デマンド【kW】</label>
                                        <div class="flex-fill d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">76</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
        
                        </div>
        
                        <div class="col-4">
                            <div class="w-100 h-100 card border-primary">
                                <div class="card-body ratio" style="--bs-aspect-ratio: 50%; max-width: 400px;">
                                    <div id="demandGauge"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 発電状況フレーム -->
                <div class="container mt-3">
                    <div class="row g-3">
                        <div class="col-8 text-center fs-6 fw-bold">
        
                            <div class="row row-cols-2 align-items-stretch g-3">

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>当日発電量【kWh】</label>
                                        <div class="flex-grow-1 d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">75</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>当月発電量【kWh】</label>
                                        <div class="flex-grow-1 d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">110</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label>当日発電率【%】</label>
                                        <div class="flex-grow-1 d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">50</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="p-2 border border-primary rounded d-flex flex-column">
                                        <label">当月発電率【%】</label>
                                        <div class="flex-grow-1 d-flex justify-content-center align-items-end">
                                            <label class="text-primary fs-1">76</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
        
                        </div>

                        <div class="col-4">
                            <div class="w-100 h-100 card border-primary">
                                <div class="card-body ratio" style="--bs-aspect-ratio: 50%; max-width: 400px;">
                                    <div id="demandGauge"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 空調制御タブ -->
            <div class="tab-pane fade" id="nav-ac" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                
                <div class="pb-3 fs-5 fw-bold d-flex justify-content-end border-bottom border-primary-subtle">
                    <div class="p-2 border border-primary rounded">
                        <div class="form-check form-check-reverse form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                            <label class="form-check-label" for="flexSwitchCheckDefault">システム運転制御</label>
                        </div>
                        <div class="form-check form-check-reverse form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked" checked>
                            <label class="form-check-label" for="flexSwitchCheckChecked">デマンド制御</label>
                        </div>
                    </div>
                </div>

                <table class="mt-3 table table-striped">
                    <thead>
                        <tr>
                            <th>接点名</th>
                            <th>復帰スケジュール</th>
                            <th>自動・手動</th>
                            <th>運転状態</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                        <tr>
                            <td>ノード1</td>
                            <td>自動制御まで後30分</td>
                            <td>手動制御中</td>
                            <td class="text-danger">制御中</td>
                        </tr>
                        <tr>
                            <td>ノード2</td>
                            <td>-</td>
                            <td>自動制御中</td>
                            <td class="text-danger">解除中</td>
                        </tr>
                        <tr>
                            <td>ノード3</td>
                            <td>自動制御まで後30分</td>
                            <td>手動制御中</td>
                            <td style="color: orange;">制御中</td>
                        </tr>
                        <tr>
                            <td>ノード4</td>
                            <td>-</td>
                            <td>自動制御中</td>
                            <td>デマンド制御中</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="tab-pane fade" id="nav-ventilation" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
                換気制御
            </div>
            <div class="tab-pane fade" id="nav-inverter" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">
                <table class="mt-3 table table-striped">
                    <thead>
                        <tr>
                            <th>名称</th>
                            <th>運転モード</th>
                            <th>周波数</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                        <tr>
                            <td>集塵ファンインバータ制御A</td>
                            <td>PID制御(自動)</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>

    <script src="./js/bootstrap/5/bootstrap.bundle.min.js"></script>
    <script src="./js/echarts/5/echarts.js"></script>
    <script>
        let guageInstance = echarts.init(document.querySelector('#demandGauge'));
        let option = {
            series: [
                {
                    type: 'gauge',
                    startAngle: 180,
                    endAngle: 0,
                    center: ['50%', '80%'],
                    radius: '120%',
                    axisLine: {
                        lineStyle: {
                            width: 40
                        }
                    },
                    progress: {
                        show: true,
                        width: 40,
                        itemStyle: {
                            color: 'green'
                        }
                    },
                    pointer: {
                        icon: 'path://M12.8,0.7l12,40.1H0.7L12.8,0.7z',
                        length: '12%',
                        width: 20,
                        offsetCenter: [0, '-60%'],
                        itemStyle: {
                            color: 'green'
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        show: false
                    },
                    title: {
                        offsetCenter: [0, '10%'],
                        fontSize: 20
                    },
                    detail: {
                        fontSize: 30,
                        offsetCenter: [0, '-20%'],
                        valueAnimation: true,
                        color: 'black',
                        formatter: function(value){

                            if(value > 85){
                                return '危険';
                            }
                            if(value > 65){
                                return '注意';
                            }
                            return '余裕';
                        }
                    },
                    data: [
                            {
                                value: 70,
                            }
                    ]
                }
            ]
        };
        guageInstance.setOption(option);

        setInterval(() => {
            let nextValue = parseInt(Math.random() * 100);
            let color = 'green';

            if(nextValue > 85){
                color = 'red';
            } else if(nextValue > 65){
                color = 'yellow';
            }

            guageInstance.setOption({
                series: [{
                    progress: {
                        itemStyle: {
                            color: color
                        }
                    },
                    pointer: {
                        itemStyle: {
                            color: color
                        }
                    },
                    data: [
                        {
                            value: nextValue,
                        }
                    ]
                }]
            })
        }, 5000);

        window.addEventListener('resize', () => guageInstance.resize());

        let themeSlt = document.querySelector('#theme');
        themeSlt.addEventListener('change', () => {
            
            if(themeSlt.value != null){
                let bootstrapCss = document.querySelector('#bootstrap');
                let parent = bootstrapCss.parentNode;
                
                bootstrapCss.parentNode.removeChild(bootstrapCss);
            
                bootstrapCss = document.createElement('link');
                bootstrapCss.id = 'bootstrap';
                bootstrapCss.rel = 'stylesheet';
                bootstrapCss.type = 'text/css';
                bootstrapCss.href = `./css/bootstrap/5/bootstrap-${themeSlt.value}.min.css`;

                parent.insertBefore(bootstrapCss, document.querySelector('#bootstrapIcon'));
            }
        });
    </script>
  </body>
</html>